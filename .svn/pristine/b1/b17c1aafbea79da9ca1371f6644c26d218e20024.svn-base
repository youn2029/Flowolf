<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
    
<form action="">

	<!-- tab-con-box:s -->
	<div class="tab-con-box">
		<!-- 업무명:s -->
		<div class="input-box">
			<input type="text" class="font-bold size-18" placeholder="업무명을 입력하세요." required="required">
		</div>
		<!-- 업무명:f -->
		
		<!-- 업무상태:s -->
		<div class="input-box martop-15">
			<dl>
				<dt class="maright-20"><i class="fas fa-user-clock"></i></dt>
				<dd>
					<div class="task-state-list">
						<label for="sRequest" class="checked">
							요청<input type="radio" name="task-state" value="요청" id="sRequest" class="dis-none">
						</label>
						<label for="sPrograss">
							진행<input type="radio" name="task-state" value="진행" id="sPrograss" class="dis-none">
						</label>
						<label for="sFeedback">
							피드백<input type="radio" name="task-state" value="피드백" id="sFeedback" class="dis-none">
						</label>
						<label for="sComplete">
							완료<input type="radio" name="task-state" value="완료" id="sComplete" class="dis-none">
						</label>
						<label for="sHold">
							보류<input type="radio" name="task-state" value="보류" id="sHold" class="dis-none">
						</label>
					</div>
				</dd>
			</dl>
		</div>
		<!-- 업무상태:f -->
		
		<!-- 담당자:s -->
		<div class="input-box martop-15" style="height:inherit">
			<dl>
				<dt class="maright-20"><i class="fas fa-user-plus"></i></dt>
				<dd class="posi-re">
					<input type="text" id="taskUser" placeholder="담당자 추가">
					
					<!-- 담당자 리스트 -->
					<div class="task-user-list">
					</div>
					
					<!-- 프로젝트 참여자 리스트(담당자 설정 리스트):s -->
					<div class="pro-user-list">
						<!-- 아래 ".pro-user-info" 를 foreach 돌리면 됨 -->
						<div class="pro-user-info">
							<div class="pro-user-photo maright-10">
								<i class="icon-circle circle-s"></i>
								<img src="/image/user-pic-sample.png" onerror="this.src='/image/user-pic-sample.png'" width="40">
							</div>
							<span class="user-id">아이디</span>
						</div>
						<div class="pro-user-info">
							<div class="pro-user-photo maright-10">
								<i class="icon-circle circle-s"></i>
								<img src="/image/user-pic-sample.png" onerror="this.src='/image/user-pic-sample.png'" width="40">
							</div>
							<span class="user-id">아이디2</span>
						</div>
					</div>
					<!-- 프로젝트 참여자 리스트(담당자 설정 리스트):f -->
				</dd>
			</dl>
		</div>
		<!-- 담당자:f -->
		
		<button type="button" class="add-item-btn"><i class="fas fa-angle-down maright-10"></i> 추가 항목 입력</button>
		
		<!-- 시작일:s -->
		<div class="input-box martop-15 add-item-box">
			<dl>
				<dt class="maright-20"><i class="flow-icon icon-task icon-sDate"></i></dt>
				<dd class="posi-re">
					<label for="sdate">
						<span class="maright-15 font-normal color-gray-l">시작일설정</span>
						<input type="date" id="sdate">
					</label>
				</dd>
			</dl>
		</div>
		<!-- 시작일:f -->
		
		<!-- 마감일:s -->
		<div class="input-box martop-15 add-item-box">
			<dl>
				<dt class="maright-20"><i class="flow-icon icon-task icon-fDate"></i></dt>
				<dd class="posi-re">
					<label for="fdate">
						<span class="maright-15 font-normal color-gray-l">마감일설정</span>
						<input type="date" id="fdate">
					</label>
				</dd>
			</dl>
		</div>
		<!-- 마감일:f -->
		
		<!-- 작업진척도:s -->
		<div class="input-box martop-15 add-item-box">
			<dl>
				<dt class="maright-20"><i class="far fa-chart-bar"></i></dt>
				<dd>
					<div class="work-range">
						<span class="work-percent"></span>
						<div class="pcnt-bar"></div>
						<div class="pcnt-btn pcnt-20"><span>20</span></div>
						<div class="pcnt-btn pcnt-40"><span>40</span></div>
						<div class="pcnt-btn pcnt-60"><span>60</span></div>
						<div class="pcnt-btn pcnt-80"><span>80</span></div>
						<div class="pcnt-btn pcnt-100"><span>100</span></div>
					</div>
				</dd>
			</dl>
		</div>
		<!-- 작업진척도:f -->
		
		<!-- 우선순위:s -->
		<div class="input-box martop-15 add-item-box">
			<dl>
				<dt class="maright-20"><i class="fas fa-flag"></i></dt>
				<dd class="posi-re">
					<input type="text" class="task-rank-input" placeholder="우선순위 선택" readonly>
					<span class="task-rank"></span>
					
					<!-- 프로젝트 참여자 리스트(담당자 설정 리스트):s -->
					<ul class="task-rank-list">
						<li><i class="flow-icon rank-icon icon-low"></i>낮음</li>
						<li><i class="flow-icon rank-icon icon-basic"></i>보통</li>
						<li><i class="flow-icon rank-icon icon-high"></i>높음</li>
						<li><i class="flow-icon rank-icon icon-emer"></i>긴급</li>
					</ul>
				</dd>
			</dl>
		</div>
		<!-- 우선순위:f -->
		
		<!-- 글 -->
		<textarea rows="5" cols="" class="martop-20" placeholder="글을 작성하세요."></textarea>
		
		<!-- 이미지 목록이 나올부분 -->
		<div class="upload-img-list">
		</div>
		
		<!-- 첨부파일 목록이 나올부분 -->
		<div class="upload-file-list">
		</div>
	</div>
	<!-- tab-con-box:f -->
	
	<!-- tab-dn-box:s -->
	<div class="tab-dn-box">
		<!-- 파일첨부 -->
		<label for="articleFileTask" class="float-left maright-20 marbtm-0 font-thin size-18">
			<i class="fas fa-paperclip maright-10"></i>파일첨부
		</label>
		<input type="file" id="articleFileTask" class="dis-none" onchange="fileUpload(this)">
		
		<!-- 이미지첨부 -->
		<label for="articleImgTask" class="float-left marbtm-0 font-thin size-18">
			<i class="fas fa-camera maright-10"></i>이미지첨부
		</label>
		<input type="file" id="articleImgTask" class="dis-none" onchange="imgUpload(this)" accept="image/*">
		
		<!-- 올리기(submit) 버튼 -->
		<input type="submit" value="올리기" class="article-submit-btn float-right font-bold size-18 color-white text-center default-back-color">
	</div>
	<!-- tab-dn-box:f -->
</form>

<script type="text/javascript">
$(function(){

	// 업무상태 설정 : 해당 업무상태 선택시, 각 업무상태에 맞게 색상 변경 클래스 추가
	$(".input-box .task-state-list label").on("click", function(){
		$(".input-box .task-state-list label").removeClass("checked");
		$(this).addClass("checked");
	});

	// 업무담당자 input란에 focus 되었을 때
	$("#taskUser").focus(function() {
		$(this).siblings(".pro-user-list").fadeIn();
		$(this).on("blur", function(){
			$(this).siblings(".pro-user-list").fadeOut();
		});
	});
	
	// 업무담당자 리스트박스에서 선택했을 때
	$(".pro-user-info").on("click", function(){
		var src = $(this).find("img").attr("src");
		var name = $(this).find(".user-id").text();
		
		if($(".task-user-list").find("div").hasClass("name-"+name)) {
			alert("이미 선택된 참여자를 다시 추가할 수 없습니다.");
		} else {
			$(".task-user-list").addClass("martop-10");
			$(".task-user-list").append(
				"<div class=\"name-tag name-" + name + "\">"
					+ "<img src=\"" + src + "\" onerror=\"this.src='/image/user-pic-sample.png'\" width=\"24\">"
					+ "<strong class=\"marleft-10\">" + name + "</strong>"
					+ "<i class=\"fas fa-times-circle marleft-15\"></i>"
					+ "<input type=\"hidden\" name=\"task-manager\" value=\"" + name + "\">"
				+ "</div>"
			);
			
			// 추가된 담당자 삭제
			$(".name-tag").find("i").click(function(){
				$(this).parent("div").remove();
			});
		}
	});
	
	// 추가 항목 입력 버튼 클릭시
	$(".add-item-btn").on("click", function(){
		$(this).fadeOut("fast");
		$(this).siblings(".add-item-box").fadeIn();
	});
	
	// percent info show & hide
	$(".pcnt-btn").on("mouseover", function(){
		$(this).find("span").show();
	}).on("mouseleave", function(){
		$(this).find("span").hide();
	});
	
	// percent bar animated
	$(".pcnt-btn").on("click", function(){
		var pcntInfo = $(this).find("span").text();
		var pcntResult = (100 - pcntInfo) + "%";
		$(".work-percent").html(pcntInfo + "%");
		$(".pcnt-bar").css("right",pcntResult);
		
		if(pcntInfo >= 60){
			$(".work-percent").addClass("color-white");
			$(".work-percent").removeClass("color-black");
		} else {
			$(".work-percent").removeClass("color-white");
			$(".work-percent").addClass("color-black");
		}
	});
	
	// 업무 우선순위 리스트 박스 보이기(input)
	$(".task-rank-input").focus(function() {
		$(this).siblings(".task-rank-list").fadeIn();
		$(this).on("blur", function(){
			$(this).siblings(".task-rank-list").fadeOut();
		});
	});
	
	// 업무 우선순위 리스트 박스 보이기(span)
	$(".task-rank").on("click", function(){
		$(this).siblings(".task-rank-input").focus();
	});
	
	// 업무 우선순위 선택했을 떄 설정
	$(".task-rank-list").find("li").on("click", function(){
		var iconClass = $(this).find("i").attr("class").split(" ")[2];
		var taskRank = $(this).parent("ul").siblings("span.task-rank");
		taskRank.css("right", "0");
		taskRank.html(
			"<i class=\"flow-icon rank-icon " + iconClass + "\"></i>"
			+ $(this).text()
			+ "<i class=\"fas fa-times-circle marleft-15 color-gray\" style=\"cursor:pointer\"></i>"
			+ "<input type=\"hidden\" name=\"task-rank\" value=\"" + $(this).text() + "\">"
		);
		taskRank.find("i.fas.fa-times-circle").on("click", function(){
			taskRank.html('');
			taskRank.css("right", "100%");
		});
	});
	
});
</script>